popinfo = read.table("POPINFO.txt", sep = "\t", header = TRUE)
ind_IDs = read.table("./data/batch_10/batch_10.mdist.id", sep = "\t", header = FALSE)
names(ind_IDs) <- c('pop', 'ind')
ind_IDs$SILLI <- str_split_fixed(ind_IDs$ind, '_', 2)[,1]
merge(ind_IDs, popinfo)
names(ind_IDs) <- c('POPNUM', 'IND')
ind_IDs$SILLI <- str_split_fixed(ind_IDs$ind, '_', 2)[,1]
merge(ind_IDs, popinfo)
names(ind_IDs) <- c('POPNUM', 'IND')
ind_IDs$SILLI <- str_split_fixed(ind_IDs$IND, '_', 2)[,1]
merge(ind_IDs, popinfo)
names(ind_IDs) <- c('POPNUM', 'IND')
ind_IDs$SILLI <- str_split_fixed(ind_IDs$IND, '_', 2)[,1]
ind_IDs_with_POPINFO <- merge(ind_IDs, popinfo)
popinfo = read.table("POPINFO.txt", sep = "\t", header = TRUE)
ind_IDs = read.table("./data/batch_10/batch_10.mdist.id", sep = "\t", header = FALSE)
names(ind_IDs) <- c('POPNUM', 'IND')
ind_IDs$SILLI <- str_split_fixed(ind_IDs$IND, '_', 2)[,1]
ind_IDs_with_POPINFO <- merge(ind_IDs, popinfo)
ind_IDs_with_POPINFO
mds = read.table(".data/batch_10/batch_10.dist_mds", sep = "\t", header = TRUE)
mds = read.table(".data/batch_10/batch_10.dist_mds", sep = "\t", header = TRUE)
mds = read.table("./data/batch_10/batch_10.dist_mds", sep = "\t", header = TRUE)
mds$TIMING
View(mds)
library(RColorBrewer)
my.cols <- brewer.pal(10, "Set1")
my.cols <- brewer.pal(9, "Set1")
my.cols <- brewer.pal(9, "Set1")
my.cols
my_cols <- c("#000000", brewer.pal(9, "Set1"))
my_cols
locus_weights <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec.var", sep = "\t", header = TRUE )
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE )
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = TRUE )
locus_weights <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec.var", sep = "\t", header = TRUE )
locus_weights <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec.var", sep = " ", header = TRUE )
View(locus_weights)
locus_weights <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec.var", header = TRUE )
locus_weights <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec.var", header = FALSE )
locus_weights <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec.var")
locus_weights <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec.var", header = TRUE)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = TRUE)
eigenval
View(eigenvec)
View(eigenvec)
View(locus_weights)
View(eigenval)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = FALSE)
View(eigenval)
?ordi.monte
??ordi.monte
install.packages("vegan")
install.packages("nFactors")
locus_weights <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec.var", header = TRUE)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = FALSE)
parallel(subject = 160, var = 100, rep = 100, quantile = .05)
library(nfactors)
parallel(subject = 160, var = 100, rep = 100, quantile = .05)
library(nFactors)
parallel(subject = 160, var = 100, rep = 100, quantile = .05)
PA_sim <- parallel(subject = 160, var = 100, rep = 100, quantile = .05)
summary(PA_sim)
PA_sim
len(eigenvec)
length(eigenvec)
nrows(eigenvec)
nrow(eigenvec)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .05)
PA_sim
plotParallel(PA_sim)
eigenval
plotParallel(PA_sim, x= eigenval$V1)
plotuScree(x= eigenval$V1)
plotParallel(PA_sim, x= eigenval$V1)
library(nFactors)
# need to remove A1\t from the eigenvec.var file
locus_weights <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec.var", header = TRUE)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = FALSE)
library(nFactors)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = FALSE)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .05)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
plotParallel(PA_sim, x= eigenval$V1)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .05)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = FALSE)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .05)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
plotParallel(PA_sim, x= eigenval$V1)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .05)
plotParallel(PA_sim, x= eigenval$V1)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
View(eigenvec)
ndim(eigenvec)
dim(eigenvec)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .05)
locus_weights <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec.var", header = TRUE)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = FALSE)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .05)
plotParallel(PA_sim, x= eigenval$V1)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .01)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .01)
plotParallel(PA_sim, x= eigenval$V1)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .01)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .01)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .01)
plotParallel(PA_sim, x= eigenval$V1)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 10000, quantile = .01)
plotParallel(PA_sim, x= eigenval$V1)
plotParallel(PA_sim, x= eigenval$V1)
mean(eigenval$V1)
View(eigenvec)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = FALSE)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 10000, quantile = .01)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = FALSE)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 10000, quantile = .01)
plotParallel(PA_sim, x= eigenval$V1)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = FALSE)
plotParallel(PA_sim, x= eigenval$V1)
smartPCA_eval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.test.eval", sep = "\t", header = FALSE)
View(smartPCA_eval)
plotParallel(PA_sim, x= eigenval$V1)
plotParallel(PA_sim, x= smartPCA_eval$V1)
smartPCA_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.test.eval", sep = "\t", header = TRUE)
View(smartPCA_evec)
smartPCA_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.test.evec", sep = "\t", header = TRUE)
View(smartPCA_evec)
smartPCA_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.test.evec", header = TRUE)
smartPCA_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.test.evec", header = FALSE, skip =  1)
View(smartPCA_evec)
?read.table
smartPCA_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.test.evec", header = FALSE, skip =  1, row.names= 1)
View(smartPCA_evec)
smartPCA_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.test.evec", header = FALSE, skip =  1, row.names= 1)
View(smartPCA_evec)
length(smartPCA_evec)
locus_weights <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec.var", header = TRUE)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = FALSE)
smartPCA_eval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.test.eval", sep = "\t", header = FALSE)
smartPCA_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.test.evec", header = FALSE, skip =  1, row.names= 1)
View(smartPCA_evec)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(eigenvec)-2, rep = 1000, quantile = .01)
PA_sim <- parallel(subject = nrow(eigenvec), var = length(smartPCA_evec)-1, rep = 1000, quantile = .01)
plotParallel(PA_sim, x= eigenval$V1)
plotParallel(PA_sim, x= smartPCA_eval$V1)
View(smartPCA_evec)
smartPCA_eve[,1]
smartPCA_evec[,1]
plot(smartPCA_evec[,1], smartPCA_evec[,2])
smartPCA_missingness_eval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.missingness.eval", sep = "\t", header = FALSE)
smartPCA_missingness_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.missingness.evec", header = FALSE, skip =  1, row.names= 1)
smartPCA_genotypes_eval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.genotypes.eval", sep = "\t", header = FALSE)
smartPCA_genotypes_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.genotypes.evec", header = FALSE, skip =  1, row.names= 1)
library(ggplot2)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = FALSE)
smartPCA_missingness_eval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.missingness.eval", sep = "\t", header = FALSE)
smartPCA_missingness_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.missingness.evec", header = FALSE, skip =  1, row.names= 1)
smartPCA_genotypes_eval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.genotypes.eval", sep = "\t", header = FALSE)
smartPCA_genotypes_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.genotypes.evec", header = FALSE, skip =  1, row.names= 1)
names(smartPCA_genotypes_eval)
names(smartPCA_genotypes_evec)
ggplot(data = smartPCA_genotypes_evec, aes(x = V2, y = V3)) + geom_point()
genotype_IDs = read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.grm.genotypes.out.id")
genotype_IDs = read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.grm.genotypes.out.id", header = FALSE )
genotype_IDs
missingness_IDs = read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.grm.missingness.out.id", header = FALSE)
genotype_IDs = read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.grm.genotypes.out.id", header = FALSE)
missingness_IDs = read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.grm.missingness.out.id", header = FALSE)[2]
missingness_IDs
library(stringr)
?str_split_fixed()
str_split_fixed(missingness_IDs, ":", 2)
str_split_fixed(missingness_IDs$V2, ":", 2)
data.frame(str_split_fixed(missingness_IDs$V2, ":", 2))
missingness_IDs = read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.grm.missingness.out.id", header = FALSE)
genotype_IDs = read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.grm.genotypes.out.id", header = FALSE)
missingness_IDs = data.frame(str_split_fixed(missingness_IDs$V2, ":", 2))
genotype_IDs = data.frame(str_split_fixed(genotype_IDs$V2, ":", 2))
genotype_IDs
missingness_IDs = read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.grm.missingness.out.id", header = FALSE)
genotype_IDs = read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.grm.genotypes.out.id", header = FALSE)
missingness_IDs = data.frame(str_split_fixed(missingness_IDs$V2, ":", 2))
genotype_IDs = data.frame(str_split_fixed(genotype_IDs$V2, ":", 2))
names(missingness_IDs) <- c('pop', 'ind')
names(genotype_IDs) <- c('pop', 'ind')
genotype_IDs
ggplot(data = smartPCA_genotypes_evec, aes(x = V2, y = V3)) + geom_point(data = genotype_IDs, aes(color = pop))
smartPCA_genotypes_evec
View(smartPCA_missingness_evec)
View(smartPCA_genotypes_evec)
cbind(genotype_IDs, smartPCA_genotypes_evec)
smartPCA_genotypes_evec
smartPCA_missingness_eval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.missingness.eval", sep = "\t", header = FALSE)
smartPCA_missingness_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.missingness.evec", header = FALSE, skip =  1, row.names= 1)
smartPCA_genotypes_eval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.genotypes.eval", sep = "\t", header = FALSE)
smartPCA_genotypes_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.genotypes.evec", header = FALSE, skip =  1, row.names= 1)
missingness_IDs = read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.grm.missingness.out.id", header = FALSE)
genotype_IDs = read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.grm.genotypes.out.id", header = FALSE)
missingness_IDs = data.frame(str_split_fixed(missingness_IDs$V2, ":", 2))
genotype_IDs = data.frame(str_split_fixed(genotype_IDs$V2, ":", 2))
names(missingness_IDs) <- c('pop', 'ind')
names(genotype_IDs) <- c('pop', 'ind')
smartPCA_missingness_eval
smartPCA_missingness_evec
smartPCA_genotypes_evec[1]
cbind(genotype_IDs, smartPCA_genotypes_evec)
cbind(genotype_IDs, smartPCA_genotypes_evec)$pop
ggplot(data = smartPCA_genotypes_evec, aes(x = V2, y = V3, color = pop)) + geom_point()
smartPCA_genotypes <- cbind(genotype_IDs, smartPCA_genotypes_evec)
ggplot(data = smartPCA_genotypes, aes(x = V2, y = V3, color = pop)) + geom_point()
row.names(smartPCA_genotypes_evec)
str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2)
cbind(str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2), smartPCA_genotypes_evec)
aa = cbind(str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2), smartPCA_genotypes_evec)
names(aa) <- c('pop', 'ind')
aa
View(aa)
View(aa)
aa
missingness_IDs = str_split_fixed(row.names(smartPCA_missingness_evec), ":", 2)
e
genotype_IDs = str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2)
missingness_IDs = str_split_fixed(row.names(smartPCA_missingness_evec), ":", 2)
genotype_IDs = str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2)
names(missingness_IDs) <- c('pop', 'ind')
names(genotype_IDs) <- c('pop', 'ind')
missingness_IDs = str_split_fixed(row.names(smartPCA_missingness_evec), ":", 2)
genotype_IDs = str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2)
names(missingness_IDs) <- c('pop', 'ind')
names(genotype_IDs) <- c('pop', 'ind')
smartPCA_missingness <- cbind(missingness_IDs, smartPCA_missingness_evec)
smartPCA_genotypes <- cbind(genotype_IDs, smartPCA_genotypes_evec)
ggplot(data = smartPCA_genotypes, aes(x = V2, y = V3, color = pop)) + geom_point()
smartPCA_genotypes
View(smartPCA_genotypes)
names(missingness_IDs) <- c('pop', 'ind')
names(genotype_IDs) <- c('pop', 'ind')
smartPCA_missingness <- cbind(missingness_IDs, smartPCA_missingness_evec)
smartPCA_genotypes <- cbind(genotype_IDs, smartPCA_genotypes_evec)
ggplot(data = smartPCA_genotypes, aes(x = V2, y = V3, color = pop)) + geom_point()
missingness_IDs = str_split_fixed(row.names(smartPCA_missingness_evec), ":", 2)
genotype_IDs = str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2)
names(missingness_IDs) <- c('pop', 'ind')
names(genotype_IDs) <- c('pop', 'ind')
genotype_IDs
genotype_IDs = str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2)
genotype_IDs = data.frame(str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2))
missingness_IDs = data.frame(str_split_fixed(row.names(smartPCA_missingness_evec), ":", 2))
missingness_IDs = data.frame(str_split_fixed(row.names(smartPCA_missingness_evec), ":", 2))
genotype_IDs = data.frame(str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2))
names(missingness_IDs) <- c('pop', 'ind')
names(genotype_IDs) <- c('pop', 'ind')
smartPCA_missingness <- cbind(missingness_IDs, smartPCA_missingness_evec)
smartPCA_genotypes <- cbind(genotype_IDs, smartPCA_genotypes_evec)
ggplot(data = smartPCA_genotypes, aes(x = V2, y = V3, color = pop)) + geom_point()
ggplot(data = smartPCA_missingness, aes(x = V2, y = V3, color = pop)) + geom_point()
smartPCA_genotypes_eval
?rep()
?seq
names(smartPCA_genotypes_evec) <- seq(1, length(smartPCA_genotypes_evec))
smartPCA_missingness_eval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.missingness.eval", sep = "\t", header = FALSE)
smartPCA_missingness_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.missingness.evec", header = FALSE, skip =  1, row.names= 1)
smartPCA_genotypes_eval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.genotypes.eval", sep = "\t", header = FALSE)
smartPCA_genotypes_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.genotypes.evec", header = FALSE, skip =  1, row.names= 1)
names(smartPCA_genotypes_evec) <- seq(1, length(smartPCA_genotypes_evec))
names(smartPCA_missingness_evec) <- seq(1, length(smartPCA_missingness_evec))
missingness_IDs = data.frame(str_split_fixed(row.names(smartPCA_missingness_evec), ":", 2))
genotype_IDs = data.frame(str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2))
names(missingness_IDs) <- c('pop', 'ind')
names(genotype_IDs) <- c('pop', 'ind')
smartPCA_missingness <- cbind(missingness_IDs, smartPCA_missingness_evec)
smartPCA_genotypes <- cbind(genotype_IDs, smartPCA_genotypes_evec)
ggplot(data = smartPCA_genotypes, aes(x = V2, y = V3, color = pop)) + geom_point()
ggplot(data = smartPCA_genotypes, aes(x = 1, y = 2, color = pop)) + geom_point()
ggplot(data = smartPCA_missingness, aes(x = 1, y = 2, color = pop)) + geom_point()
ggplot(data = smartPCA_missingness, aes(x = 1, y = 2, color = pop)) + geom_point()
names(smartPCA_genotypes_evec) <- paste('dim', seq(1, length(smartPCA_genotypes_evec), sep = ""))
names(smartPCA_genotypes_evec) <- paste('dim', seq(1, length(smartPCA_genotypes_evec, sep = "")))
names(smartPCA_genotypes_evec) <- paste('dim', seq(1, length(smartPCA_genotypes_evec), sep = ""))
paste('dim', seq(1, length(smartPCA_genotypes_evec), sep = ""))
?paste
paste('dim', seq(1, length(smartPCA_genotypes_evec)))
paste('dim', seq(1, length(smartPCA_genotypes_evec)), sep = "")
names(smartPCA_missingness_evec) <-  paste('dim', seq(1, length(smartPCA_missingness_evec)), sep = "")
names(smartPCA_genotypes_evec) <- paste('dim', seq(1, length(smartPCA_genotypes_evec)), sep = "")
missingness_IDs = data.frame(str_split_fixed(row.names(smartPCA_missingness_evec), ":", 2))
genotype_IDs = data.frame(str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2))
names(missingness_IDs) <- c('pop', 'ind')
names(genotype_IDs) <- c('pop', 'ind')
smartPCA_missingness <- cbind(missingness_IDs, smartPCA_missingness_evec)
smartPCA_genotypes <- cbind(genotype_IDs, smartPCA_genotypes_evec)
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point()
ggplot(data = smartPCA_genotypes, aes(x = dim1, y = dim2, color = pop)) + geom_point()
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 4, alpha = .8)
ggplot(data = smartPCA_genotypes, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 4, alpha = .8)
plotParallel(PA_sim, x= smartPCA_eval$V1)
plotParallel(PA_sim, x= eigenval$V1)
plotuScree(x= eigenval$V1)
plotParallel(PA_sim, x= smartPCA_eval$V1)
plotParallel(PA_sim, x= smartPCA__genotypes_eval$V1)
library(nFactors)
library(stringr)
eigenvec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenvec", sep = "\t", header = TRUE)
eigenval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/FISH_560/FISH_560.final.eigenval", sep = "\t", header = FALSE)
smartPCA_missingness_eval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.missingness.eval", sep = "\t", header = FALSE)
smartPCA_missingness_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.missingness.evec", header = FALSE, skip =  1, row.names= 1)
smartPCA_genotypes_eval <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.genotypes.eval", sep = "\t", header = FALSE)
smartPCA_genotypes_evec <- read.table("/home/ipseg/Desktop/waples/chum_populations/data/test_EIGENSTRAT/FISH_560.genotypes.evec", header = FALSE, skip =  1, row.names= 1)
names(smartPCA_genotypes_evec) <- paste('dim', seq(1, length(smartPCA_genotypes_evec)), sep = "")
names(smartPCA_missingness_evec) <-  paste('dim', seq(1, length(smartPCA_missingness_evec)), sep = "")
missingness_IDs = data.frame(str_split_fixed(row.names(smartPCA_missingness_evec), ":", 2))
genotype_IDs = data.frame(str_split_fixed(row.names(smartPCA_genotypes_evec), ":", 2))
names(missingness_IDs) <- c('pop', 'ind')
names(genotype_IDs) <- c('pop', 'ind')
smartPCA_missingness <- cbind(missingness_IDs, smartPCA_missingness_evec)
smartPCA_genotypes <- cbind(genotype_IDs, smartPCA_genotypes_evec)
library(ggplot2)
ggplot(data = smartPCA_genotypes, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 4, alpha = .8)
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 4, alpha = .8)
plotParallel(PA_sim, x= smartPCA_genotypes_eval$V1)
smartPCA_genotypes_eval
ggplot(data = smartPCA_genotypes_eval, aes(x=V1)) + geom_point()
ggplot(data = smartPCA_genotypes_eval, aes(x=V1)) + geom_point()
smartPCA_genotypes_eval
ggplot(data = smartPCA_genotypes_eval, aes(x=V1))
ggplot(data = smartPCA_genotypes_eval, aes(x=V1)) + geom_point(size = 4, alpha = .8)
ggplot(data = smartPCA_genotypes_eval, aes(x=V1, y = row.names)) + geom_point(size = 4, alpha = .8)
ggplot(data = smartPCA_genotypes_eval, aes(x=V1, y = row.names)) + geom_point(y = seq(158))
y = seq(158)
seq(158)
names(smartPCA_genotypes_eval)
row.names(smartPCA_genotypes_eval)
ggplot(data = smartPCA_genotypes_eval, aes(x=V1, y = row.names)) + geom_point(y = row.names(smartPCA_genotypes_eval))
ggplot(data = smartPCA_genotypes_eval, aes(x=V1)) + geom_point(y = row.names(smartPCA_genotypes_eval))
ggplot(data = smartPCA_genotypes_eval, aes(x=V1)) + geom_point(aes(y = row.names(smartPCA_genotypes_eval)))
smartPCA_genotypes_eval
plot(smartPCA_genotypes_eval)
plot(smartPCA_genotypes_eval$V1)
nrow(smartPCA_genotypes_eval)
smartPCA_genotypes_eval$pc_axis <- seq(nrow(smartPCA_genotypes_eval))
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point() + geom_path()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(alpha = .5) + geom_path()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(alpha = .5) + geom_path(alpha = .5)
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(alpha = .5) + geom_path(alpha = .5) + theme_bw()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(size = 2, alpha = .5) + geom_path(size = 2, alpha = .5) + theme_bw()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(size = 2, alpha = .5) + geom_path(size = 1, alpha = .5) + theme_bw()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(size = 2, alpha = .8) + geom_path(size = 1, alpha = .5) + theme_bw()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(size = 2, alpha = .8, scale_shape(solid = FALSE)) + geom_path(size = 1, alpha = .5) + theme_bw()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(size = 2, alpha = .8, aes(scale_shape(solid = FALSE))) + geom_path(size = 1, alpha = .5) + theme_bw()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(size = 2, alpha = .8) + geom_path(size = 1, alpha = .5) + theme_bw()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(shape = 1,size = 2, alpha = .8) + geom_path(size = 1, alpha = .5) + theme_bw()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(shape = 1,size = 3, alpha = .8) + geom_path(size = 1, alpha = .5) + theme_bw()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(shape = 1,size = 3, alpha = .8) + geom_path(size = 1, alpha = .2) + theme_bw()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(shape = 1, size = 4, alpha = .8) + geom_path(size = 1, alpha = .2) + theme_bw()
ggplot(data = smartPCA_genotypes_eval, aes(y=V1, x=pc_axis )) + geom_point(shape = 16, size = 4, alpha = .8) + geom_path(size = 1, alpha = .2) + theme_bw()
plot(smartPCA_genotypes_eval$V1)
ggplot(data = smartPCA_genotypes, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 4, alpha = .8) + theme_bw()
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 4, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim3, y = dim4, color = pop)) + geom_point(size = 4, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim5, y = dim6, color = pop)) + geom_point(size = 4, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim7, y = dim8, color = pop)) + geom_point(size = 4, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim9, y = dim10, color = pop)) + geom_point(size = 4, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim10, y = dim11, color = pop)) + geom_point(size = 4, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim11, y = dim12, color = pop)) + geom_point(size = 4, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim3, y = dim4, color = pop)) + geom_point(size = 4, alpha = .8) + theme_bw()
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 5, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 5, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim2, y = dim3, color = pop)) + geom_point(size = 5, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim3, y = dim4, color = pop)) + geom_point(size = 5, alpha = .8) + theme_bw()
ggplot(data = smartPCA_missingness, aes(x = dim2, y = dim3, color = pop)) + geom_point(size = 5, alpha = .8) + theme_bw()
theme_set(theme_bw())
pal = "Set1"
scale_colour_discrete <- function(palname = pal, ...) {
scale_colour_brewer(palette = palname, ...)
}
scale_fill_discrete <- function(palname = pal, ...) {
scale_fill_brewer(palette = palname, ...)
}
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 5, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 5, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim3, y = dim4, color = pop)) + geom_point(size = 5, alpha = .8) + theme_bw()
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw()
ggplot(data = smartPCA_missingness, aes(x = dim2, y = dim3, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw()
plot(smartPCA_missingness$dim1, smartPCA_genotypes$dim1)
plot(smartPCA_missingness$dim1[1:158], smartPCA_genotypes$dim1)
plot(smartPCA_missingness$dim2[1:158], smartPCA_genotypes$dim2)
plot(smartPCA_missingness$dim3[1:158], smartPCA_genotypes$dim3)
plot(smartPCA_missingness$dim4[1:158], smartPCA_genotypes$dim4)
cor(smartPCA_missingness$dim4[1:158], smartPCA_genotypes$dim4)
names(smartPCA_missingness)
for xx in names(smartPCA_missingness){
cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
for (xx in names(smartPCA_missingness)) {
cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
for (xx in names(smartPCA_missingness)) {
print(xx)
#cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
for (xx in names(smartPCA_missingness)) {
print(xx)
cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
for (xx in names(smartPCA_missingness)[3:]) {
print(xx)
cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
for (xx in names(smartPCA_missingness)[3:]) {
print(xx)
cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
names(smartPCA_missingness)[3:]
names(smartPCA_missingness)[1]
names(smartPCA_missingness)[,3:]
for (xx in names(smartPCA_missingness)[,3:158]) {
print(xx)
cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
for (xx in names(smartPCA_missingness)[,3:158]) {
print(xx)
#cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
for (xx in names(smartPCA_missingness)[3:158]) {
print(xx)
#cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
for (xx in names(smartPCA_missingness)[3:158]) {
print(xx)
cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
for (xx in names(smartPCA_missingness)[3:158]) {
print(smartPCA_missingness$xx[1:158])
#cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
for (xx in names(smartPCA_missingness)[3:158]) {
print(smartPCA_missingness$xx)
#cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
ames(smartPCA_missingness)[3:158]
names(smartPCA_missingness)[3:158]
for (xx in seq(3, 158)) {
print(smartPCA_missingness[xx])
#cor(smartPCA_missingness$xx[1:158], smartPCA_genotypes$xx)
}
for (xx in seq(3, 158)) {
print(smartPCA_missingness[xx])
cor(smartPCA_missingness[xx][1:158], smartPCA_genotypes[xx])
}
xx
smartPCA_missingness[xx][1:158]
smartPCA_missingness[xx]
smartPCA_missingness[xx][,1:5]
smartPCA_missingness[xx][1:5,]
for (xx in seq(3, 158)) {
cor(smartPCA_missingness[xx][1:158,], smartPCA_genotypes[xx])
}
smartPCA_genotypes[xx]
smartPCA_genotypes
for (xx in seq(3, 158)) {
cor(smartPCA_missingness[xx][1:158,], smartPCA_genotypes[xx])
}
xx
for (xx in seq(3, 100)) {
cor(smartPCA_missingness[xx][1:158,], smartPCA_genotypes[xx])
}
for (xx in seq(3, 100)) {
print(cor(smartPCA_missingness[xx][1:158,], smartPCA_genotypes[xx]))
}
ggplot(data = smartPCA_genotypes, aes(x = dim7, y = dim8, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw()
ggplot(data = smartPCA_genotypes, aes(x = dim3, y = dim4, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw()
ggplot(data = smartPCA_missingness, aes(x = dim2, y = dim3, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw()
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw()
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim3, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw()
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw()
smartPCA_missingness
smartPCA_missingness_eval
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw() + xlab(paste("dim1", smartPCA_missingness_eval[1]) )
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw() + xlab(paste("dim1", smartPCA_missingness_eval[1][1]) )
smartPCA_missingness_eval[1]
smartPCA_missingness_eval[,1]
smartPCA_missingness_eval[,1][1]
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw() + xlab(paste("dim1", smartPCA_missingness_eval[,1][1]) )
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw() + xlab(paste("dim1", smartPCA_missingness_eval[,1][1], "%") )
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw() + xlab(paste("dim1: ", smartPCA_missingness_eval[,1][1], "%") )
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw() +
xlab(paste("dim1: ", smartPCA_missingness_eval[,1][1], "%") )
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw() +
xlab(paste("dim1: ", smartPCA_missingness_eval[,1][1], "%") )  + ylab(paste("dim2: ", smartPCA_missingness_eval[,1][2], "%") )
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + coord_equal() +theme_bw() +
xlab(paste("dim1: ", smartPCA_missingness_eval[,1][1], "%") )  + ylab(paste("dim2: ", smartPCA_missingness_eval[,1][2], "%") )
ggplot(data = smartPCA_missingness, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + coord_equal() +theme_bw() +
xlab(paste("dim1: ", smartPCA_missingness_eval[,1][1], "%") )  + ylab(paste("dim2: ", smartPCA_missingness_eval[,1][2], "%") )
ggplot(data = smartPCA_genotypes, aes(x = dim1, y = dim2, color = pop)) + geom_point(size = 6, alpha = .8) + theme_bw()  +
xlab(paste("dim1: ", smartPCA_genotypes_eval[,1][1], "%") )  + ylab(paste("dim2: ", smartPCA_genotypes_eval[,1][2], "%") )
