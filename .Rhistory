scale_x_continuous(breaks = c(1,1+which(diff(chum_ssa$LEP_LG)!=0)), labels= 0:37) +
scale_color_brewer(palette = 2, type = 'qual') + theme_bw()
ggplot(chum_ssa) + geom_point(aes(x= chum_order, y = Ssa_chr, color = factor(LEP_LG%%5)), size = 7, alpha = .4) +
scale_x_continuous(name = 'chum LG', breaks = c(1,1+which(diff(chum_ssa$LEP_LG)!=0)), labels= 0:37) +
scale_color_brewer(palette = 2, type = 'qual') + theme_bw()
ggplot(chum_ssa) + geom_point(aes(x= chum_order, y = Ssa_chr, color = factor(LEP_LG%%5)), size = 7, alpha = .6) +
scale_x_continuous(name = 'chum LG', breaks = c(1,1+which(diff(chum_ssa$LEP_LG)!=0)), labels= 0:37) +
scale_color_brewer(palette = 2, type = 'qual') + theme_bw()
chum_ssa = read.table('/home/ipseg/Desktop/waples/chum_populations/results/batch_4/synteny/chum_ssa.txt',
sep ='\t', header = TRUE)
chum_ssa = chum_ssa[order(chum_ssa$LEP_LG),]
chum_ssa$chum_order = 1:nrow(chum_ssa)
#chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr,chum_ssa$POS),]
chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr,]
chum_ssa$ssa_order = 1:nrow(chum_ssa)
ggplot(chum_ssa) + geom_point(aes(x= chum_order, y = Ssa_chr, color = factor(LEP_LG%%5)), size = 7, alpha = .6) +
scale_x_continuous(name = 'chum LG', breaks = c(1,1+which(diff(chum_ssa$LEP_LG)!=0)), labels= 0:37) +
scale_color_brewer(palette = 2, type = 'qual') + theme_bw()
library(ggplot2)
chum_ssa = read.table('/home/ipseg/Desktop/waples/chum_populations/results/batch_4/synteny/chum_ssa.txt',
sep ='\t', header = TRUE)
chum_ssa = chum_ssa[order(chum_ssa$LEP_LG),]
chum_ssa$chum_order = 1:nrow(chum_ssa)
#chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr,chum_ssa$POS),]
chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr,]
chum_ssa$ssa_order = 1:nrow(chum_ssa)
ggplot(chum_ssa) + geom_point(aes(x= chum_order, y = Ssa_chr, color = factor(LEP_LG%%5)), size = 7, alpha = .6) +
scale_x_continuous(name = 'chum LG', breaks = c(1,1+which(diff(chum_ssa$LEP_LG)!=0)), labels= 0:37) +
scale_color_brewer(palette = 2, type = 'qual') + theme_bw()
library(ggplot2)
chum_ssa = read.table('/home/ipseg/Desktop/waples/chum_populations/results/batch_4/synteny/chum_ssa.txt',
sep ='\t', header = TRUE)
chum_ssa = chum_ssa[order(chum_ssa$LEP_LG),]
chum_ssa$chum_order = 1:nrow(chum_ssa)
#chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr,chum_ssa$POS),]
chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr,]
chum_ssa$ssa_order = 1:nrow(chum_ssa)
ggplot(chum_ssa) + geom_point(aes(x= chum_order, y = Ssa_chr, color = factor(LEP_LG%%5)), size = 7, alpha = .6) +
scale_x_continuous(name = 'chum LG', breaks = c(1,1+which(diff(chum_ssa$LEP_LG)!=0)), labels= 0:37) +
scale_color_brewer(palette = 2, type = 'qual') + theme_bw()
chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr),]
library(ggplot2)
chum_ssa = read.table('/home/ipseg/Desktop/waples/chum_populations/results/batch_4/synteny/chum_ssa.txt',
sep ='\t', header = TRUE)
chum_ssa = chum_ssa[order(chum_ssa$LEP_LG),]
chum_ssa$chum_order = 1:nrow(chum_ssa)
#chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr,chum_ssa$POS),]
chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr),]
chum_ssa$ssa_order = 1:nrow(chum_ssa)
ggplot(chum_ssa) + geom_point(aes(x= chum_order, y = Ssa_chr, color = factor(LEP_LG%%5)), size = 7, alpha = .6) +
scale_x_continuous(name = 'chum LG', breaks = c(1,1+which(diff(chum_ssa$LEP_LG)!=0)), labels= 0:37) +
scale_color_brewer(palette = 2, type = 'qual') + theme_bw()
library(ggplot2)
chum_ssa = read.table('/home/ipseg/Desktop/waples/chum_populations/results/batch_4/synteny/chum_ssa.txt',
sep ='\t', header = TRUE)
chum_ssa = chum_ssa[order(chum_ssa$LEP_LG),]
chum_ssa$chum_order = 1:nrow(chum_ssa)
#chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr,chum_ssa$POS),]
chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr),]
chum_ssa$ssa_order = 1:nrow(chum_ssa)
ggplot(chum_ssa) + geom_point(aes(x= chum_order, y = Ssa_chr, color = factor(LEP_LG%%5)), size = 7, alpha = .6) +
scale_x_continuous(name = 'chum LG', breaks = c(1,1+which(diff(chum_ssa$LEP_LG)!=0)), labels= 0:37) +
scale_color_brewer(palette = 2, type = 'qual') + theme_bw()
library(ggplot2)
chum_ssa = read.table('/home/ipseg/Desktop/waples/chum_populations/results/batch_4/synteny/chum_ssa.txt',
sep ='\t', header = TRUE)
chum_ssa = chum_ssa[order(chum_ssa$LEP_LG),]
chum_ssa$chum_order = 1:nrow(chum_ssa)
#chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr,chum_ssa$POS),]
chum_ssa = chum_ssa[order(chum_ssa$Ssa_chr),]
chum_ssa$ssa_order = 1:nrow(chum_ssa)
ggplot(chum_ssa) + geom_point(aes(x= chum_order, y = Ssa_chr, color = factor(LEP_LG%%5)), size = 7, alpha = .6) +
scale_x_continuous(name = 'chum LG', breaks = c(1,1+which(diff(chum_ssa$LEP_LG)!=0)), labels= 0:37) +
scale_color_brewer(palette = 2, type = 'qual') + theme_bw()
ggplot(chum_ssa) + geom_point(aes(x= chum_order, y = Ssa_chr, color = factor(LEP_LG%%5)), size = 7, alpha = .6) +
#scale_x_continuous(name = 'chum LG', breaks = c(1,1+which(diff(chum_ssa$LEP_LG)!=0)), labels= 0:37) +
scale_color_brewer(palette = 2, type = 'qual') + theme_bw()
read.table=('/home/ipseg/Dropbox/Projects/Chinook baseline/notebooks/pairs_temp.txt', sep = '\t')
read.table('/home/ipseg/Dropbox/Projects/Chinook baseline/notebooks/pairs_temp.txt', sep = '\t')
myt = read.table('/home/ipseg/Dropbox/Projects/Chinook baseline/notebooks/pairs_temp.txt', sep = '\t')
library(ggplot2)
library(RColorBrewer)
myt = read.table('/home/ipseg/Dropbox/Projects/Chinook baseline/notebooks/pairs_temp.txt', sep = '\t')
ggplot(myt) + geom_segment(aes(x=Latitude_x, xend=Latitude_y, y=Longitude_x, yend=Longitude_y))
library(ggplot2)
library(RColorBrewer)
myt = read.table('/home/ipseg/Dropbox/Projects/Chinook baseline/notebooks/pairs_temp.txt', sep = '\t')
ggplot(myt) + geom_segment(aes(x=Latitude_x, xend=Latitude_y, y=Longitude_x, yend=Longitude_y))
View(myt)
ggplot(myt) + geom_segment(aes(x=Latitude_x, xend=Latitude_y, y=Longitude_x, yend=Longitude_y))
View(myt)
myt = read.table('/home/ipseg/Dropbox/Projects/Chinook baseline/notebooks/pairs_temp.txt', sep = '\t', header=TRUE)
ggplot(myt) + geom_segment(aes(x=Latitude_x, xend=Latitude_y, y=Longitude_x, yend=Longitude_y))
ggplot(myt) + geom_segment(aes(x=Latitude_x, xend=Longitude_x, y=Latitude_y, yend=Longitude_y))
ggplot(myt) + geom_segment(aes(x=Latitude_x, xend=Latitude_y, y=Longitude_x, yend=Longitude_y))
View(myt)
ggplot(myt) + geom_segment(aes(y=Latitude_x, yend=Latitude_y, x=Longitude_x, xend=Longitude_y))
ggplot(myt) + geom_segment(aes(y=Latitude_x, yend=Latitude_y, x=Longitude_x, xend=Longitude_y))
max(myt$Longitude_x)
min(myt$Longitude_x)
ggplot(myt) +
geom_point(aes(x=Longitude_x,y=Latitude_x)) +
geom_point(aes(x=Longitude_y,y=Latitude_y)) +
geom_segment(aes(y=Latitude_x, yend=Latitude_y, x=Longitude_x, xend=Longitude_y))
read.table('/home/ipseg/Downloads/04_Jun_13-36_Grades-FISH_310_A-_Biology_Of_Shellfishes.csv'')
read.table('/home/ipseg/Downloads/04_Jun_13-36_Grades-FISH_310_A-_Biology_Of_Shellfishes.csv')
read.table('/home/ipseg/Downloads/04_Jun_13-36_Grades-FISH_310_A-_Biology_Of_Shellfishes.csv', sep = ',')
library(ggplot)
grades = read.table('/home/ipseg/Downloads/04_Jun_13-36_Grades-FISH_310_A-_Biology_Of_Shellfishes.csv', sep = ',')
library(ggplot)
library(ggplot2)
grades = read.table('/home/ipseg/Downloads/04_Jun_13-36_Grades-FISH_310_A-_Biology_Of_Shellfishes.csv', sep = ',')
library(ggplot2)
names(grades)
grades = read.table('/home/ipseg/Downloads/04_Jun_13-36_Grades-FISH_310_A-_Biology_Of_Shellfishes.csv', sep = ',', header = TRUE)
names(grades)
hist(grades$Midterm.Lab.Practical..2843305)
hist(Final.Lab.Practical..2843307.)
hist(grades$Final.Lab.Practical..2843307.)
grades = read.table('/home/ipseg/Downloads/04_Jun_13-36_Grades-FISH_310_A-_Biology_Of_Shellfishes.csv', sep = ',', header = TRUE)
names(grades)
hist(grades$Midterm.Lab.Practical..2843305)
hist(grades$Final.Lab.Practical..2843307.)
plot(grades$Midterm.Lab.Practical..2843305, grades$Final.Lab.Practical..2843307.)
mean(grades$Final.Lab.Practical..2843307.)
mean(grades$Midterm.Lab.Practical..2843305)
mean(grades$Midterm.Lab.Practical..2843305, na.rm = TRUE)
mean(grades$Final.Lab.Practical..2843307.,  na.rm = TRUE)
library(randomForest)
library(ggplot2)
data(iris)
set.seed(71)
iris.rf <- randomForest(Species ~ ., data=iris, importance=TRUE, proximity=TRUE)
training_data = read.table('/home/ipseg/Desktop/waples/RAD_allele_depth/data/chinook.training.txt', sep = "\t", header = TRUE)
unknown_data = read.table('/home/ipseg/Desktop/waples/RAD_allele_depth/data/chinook.unknown.txt', sep = "\t", header = TRUE)
training_data$Duplicate = as.factor(training_data$Duplicate)
loci.rf <- randomForest(factor(Duplicate) ~ depth_per_het + abs_z,
data = training_data, ntree=200, mtry=2,  importance=TRUE, proximity = TRUE)
loci.rf
plot(outlier(loci.rf), type="h", col=c("red", "green", "blue")[as.numeric(training_data$Duplicate)])
plot(outlier(loci.rf), type="h")[as.numeric(training_data$Duplicate)])
plot(outlier(loci.rf), type="h")[as.numeric(training_data$Duplicate)])
plot(outlier(loci.rf), type="h", col=c("red", "green")[as.numeric(training_data$Duplicate)])
outlier(loci.rf)
library(randomForest)
library(ggplot2)
data(iris)
set.seed(71)
iris.rf <- randomForest(Species ~ ., data=iris, importance=TRUE, proximity=TRUE)
install.packages("manipulate")
training_data = read.table('/home/ipseg/Desktop/waples/RAD_allele_depth/data/chinook.training.txt', sep = "\t", header = TRUE)
unknown_data = read.table('/home/ipseg/Desktop/waples/RAD_allele_depth/data/chinook.unknown.txt', sep = "\t", header = TRUE)
training_data$Duplicate = as.factor(training_data$Duplicate)
loci.rf <- randomForest(Duplicate ~ depth_per_het * abs_z,
data = training_data, ntree=200, mtry=2,  importance=TRUE, proximity = TRUE)
loci.rf
loci.rf
names(loci.rf)
loci.rf$proximity
length(loci.rf$proximity)
class(loci.rf$proximity)
dim(loci.rf$proximity)
my_mds <- cmdscale(loci.rf$proximity,eig=TRUE, k=2)
my_mds <- cmdscale(1-loci.rf$proximity,eig=TRUE, k=3)
map_fst = read.table('/home/ipseg/Desktop/waples/chum_populations/results/batch_4/pop_analysis/map_fst.txt', header = TRUE,sep = "\t")
library(ggplot2)
library(RColorBrewer)
FDR =.05
#load base data
map_fst = read.table('/home/ipseg/Desktop/waples/chum_populations/results/batch_4/pop_analysis/map_fst.txt', header = TRUE,sep = "\t")
map_fst$Fst = map_fst[['Fst_bayescan']]
map_fst$outlier = map_fst$qval < FDR
map_fst$LG = map_fst$paper1_LG
theme(text = element_text(size=25))
ggplot(map_fst, aes(x=cM, y=Fst)) +
facet_grid(Linkage_group ~ .) +
geom_text(data = data.frame(x=25,y=.15,lab=c("Linkage group 1","Linkage group 2"), Linkage_group=c(1,2)), aes(x,y,label=lab), size = 8) +
geom_point(aes(color=Fst_outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.3) +
theme_bw() + theme(strip.text = element_blank()) +
theme(text = element_text(size=25))
ggplot(map_fst, aes(x=cM, y=Fst)) +
facet_grid(Linkage_group ~ .) +
geom_text(data = data.frame(x=25,y=.15,lab=c("Linkage group 1","Linkage group 2"), Linkage_group=c(1,2)), aes(x,y,label=lab), size = 8) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.3) +
theme_bw() + theme(strip.text = element_blank()) +
theme(text = element_text(size=25))
ggplot(map_fst, aes(x=cM, y=Fst)) +
facet_grid(Linkage_group ~ .)
ggplot(map_fst, aes(x=cM, y=Fst)) +
facet_grid(Linkage_group ~ .) +
geom_text(data = data.frame(x=25,y=.15,lab=c("Linkage group 1","Linkage group 2"), Linkage_group=c(1,2)), aes(x,y,label=lab), size = 8) +
geom_point(aes(color=outlier), alpha = .5, size = 5)
ggplot(map_fst, aes(x=cM, y=Fst)) +
facet_grid(Linkage_group ~ .) +
#geom_text(data = data.frame(x=25,y=.15,lab=c("Linkage group 1","Linkage group 2"), Linkage_group=c(1,2)), aes(x,y,label=lab), size = 8) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.3) +
theme_bw() + theme(strip.text = element_blank()) +
theme(text = element_text(size=25))
ggplot(map_fst, aes(x=cM, y=Fst)) +
facet_grid(Linkage_group ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5)
ggplot(map_fst, aes(x=cM, y=Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5)
ggplot(map_fst, aes(x=cM, y=Fst_bayescan)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5)
map_fst$outlier = map_fst$qval < FDR
map_fst$LG = map_fst$paper1_LG
ggplot(map_fst, aes(x=cM, y=Fst_bayescan)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5)
View(map_fst)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red"))
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.3)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.3) +
theme_bw() + theme(strip.text = element_blank()) +
theme(text = element_text(size=25))
ggplot(map_fst, aes(x=cM, y=BS_Fst), height=600, width=800) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.3) +
theme_bw() + theme(strip.text = element_blank()) +
theme(text = element_text(size=25))
ggplot(map_fst, aes(x=cM, y=BS_Fst), height=1600, width=800) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.3) +
theme_bw() + theme(strip.text = element_blank()) +
theme(text = element_text(size=25))
ggplot(map_fst, aes(x=cM, y=BS_Fst), height=3600, width=800) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.3) +
theme_bw() + theme(strip.text = element_blank()) +
theme(text = element_text(size=25))
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.3) +
theme_bw() + theme(strip.text = element_blank()) +
theme(text = element_text(size=25))
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=1600, width=800)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.3) +
theme_bw() + theme(strip.text = element_blank()) +
theme(text = element_text(size=25))
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=36, width=12)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.3) +
theme_bw() + theme(strip.text = element_blank()) +
theme(text = element_text(size=20))
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=50, width=12)
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=48, width=12)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.25) +
theme_bw() + theme(strip.text = element_blank()) +
theme(text = element_text(size=20))
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=48, width=12)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .5, size = 5) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.5) +
theme_bw() + theme(strip.text = element_blank()) +
theme(text = element_text(size=20))
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=48, width=12)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .7, size = 3) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.5) +
theme_bw() + theme(strip.text = element_blank()) +
theme(strip.text = element_text(size=20))
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=48, width=12)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .7, size = 3) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.5, n = 20) +
theme_bw() + theme(strip.text = element_blank()) +
theme(strip.text = element_text(size=20))
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=48, width=12)
ggplot(map_fst, aes(x=cM, y=WC_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .7, size = 3) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.5, n = 20) +
theme_bw() + theme(strip.text = element_blank()) +
theme(strip.text = element_text(size=20))
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=48, width=12)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .7, size = 3) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.5, n = 10) +
theme_bw() + theme(strip.text = element_blank()) +
theme(strip.text = element_text(size=20))
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=48, width=12)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .7, size = 3) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.1, n = 10) +
theme_bw() + theme(strip.text = element_blank()) +
theme(strip.text = element_text(size=20))
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=48, width=12)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .7, size = 3) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'loess', span=0.3, n = 10) +
theme_bw() + theme(strip.text = element_blank()) +
theme(strip.text = element_text(size=20))
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=48, width=12)
ggplot(map_fst, aes(x=cM, y=BS_Fst)) +
facet_grid(LG ~ .) +
geom_point(aes(color=outlier), alpha = .7, size = 3) +
scale_color_manual(values=c("darkgrey","red")) +
stat_smooth(fill="blue", colour="darkblue", size=2, alpha = 0.1, method = 'gam', span=0.3, n = 10) +
theme_bw() + theme(strip.text = element_blank()) +
theme(strip.text = element_text(size=20))
ggsave('/home/ipseg/Desktop/waples/chum_populations/paper/figures/supplemental/Fst_across_the_genome.png', height=48, width=12)
map_fst[map_fst$LG ==10,]
map_fst[map_fst$LG ==10,]$cM
xx = map_fst[map_fst$LG ==10,]$cM
yy = map_fst[map_fst$LG ==10,]$WC_Fst
scatter.smooth(xx, yy, span = .3)
xx = map_fst[map_fst$LG ==10,]$cM
yy = map_fst[map_fst$LG ==10,]$BS_Fst
scatter.smooth(xx, yy, span = .3)
xx = map_fst[map_fst$LG ==10,]$cM
yy = map_fst[map_fst$LG ==10,]$BS_Fst
loess.smooth(xx, yy, span = .3)
scatter.smooth(xx, yy, span = .3)
scatter.smooth(xx, yy, span = .3, evaluation =10)
scatter.smooth(xx, yy, span = .3, evaluation =1000)
scatter.smooth(xx, yy, span = .1, evaluation =1000)
scatter.smooth(xx, yy, span = .1, evaluation =10)
scatter.smooth(xx, yy, span = .1, evaluation =3)
scatter.smooth(xx, yy, span = .1, evaluation =100)
xx = map_fst[map_fst$LG ==10,]$cM
yy = map_fst[map_fst$LG ==10,]$WC_Fst
scatter.smooth(xx, yy, span = .1, evaluation =100)
xx = map_fst[map_fst$LG ==10,]$cM
yy = map_fst[map_fst$LG ==10,]$qval
scatter.smooth(xx, yy, span = .1, evaluation =100)
scatter.smooth(xx, yy, span = .5, evaluation =100)
yy = -log10(map_fst[map_fst$LG ==10,]$log10(PO))
scatter.smooth(xx, yy, span = .5, evaluation =100)
yy = -log10(map_fst[map_fst$LG ==10,]$'log10(PO)'))
yy = -log10(map_fst[map_fst$LG ==10,]$'log10(PO)')
View(map_fst)
yy = -log10(map_fst[map_fst$LG ==10,]$log10.PO.)
scatter.smooth(xx, yy, span = .5, evaluation =100)
yy = -log10(map_fst[map_fst$LG ==10,]$'log10.PO.')
scatter.smooth(xx, yy, span = .5, evaluation =100)
scatter.smooth(xx, yy, span = .5, evaluation =10)
yy
yy = -(map_fst[map_fst$LG ==10,]$'log10.PO.')
scatter.smooth(xx, yy, span = .5, evaluation =10)
yy = map_fst[map_fst$LG ==10,]$'log10.PO.'
scatter.smooth(xx, yy, span = .5, evaluation =10)
scatter.smooth(xx, yy, span = .1, evaluation =10)
yy = map_fst[map_fst$LG ==10,]$'log10.PO.'
scatter.smooth(xx, yy, span = .1, evaluation =10)
scatter.smooth(xx, yy, span = .2, evaluation =10)
yy = map_fst[map_fst$LG ==10,]$'log10.PO.'
scatter.smooth(xx, yy, span = .2, evaluation =10)
yy = map_fst[map_fst$LG ==10,]$qval
scatter.smooth(xx, yy, span = .2, evaluation =10)
yy = 1-map_fst[map_fst$LG ==10,]$qval
scatter.smooth(xx, yy, span = .2, evaluation =10)
yy = -log10(map_fst[map_fst$LG ==10,]$qval)
scatter.smooth(xx, yy, span = .2, evaluation =10)
yy = -log10(map_fst[map_fst$LG ==10,]$qval)
yy
scatter.smooth(xx, yy, span = .2, evaluation =10)
yy > 10000
xx = map_fst[map_fst$LG ==10,]$cM
yy = -log10(map_fst[map_fst$LG ==10,]$qval)
yy[yy > 10000] = 10000
scatter.smooth(xx, yy, span = .2, evaluation =10)
xx = map_fst[map_fst$LG ==10,]$cM
yy = -log10(map_fst[map_fst$LG ==10,]$qval)
yy[yy > 10000] = 100
scatter.smooth(xx, yy, span = .2, evaluation =10)
xx = map_fst[map_fst$LG ==10,]$cM
yy = -log10(map_fst[map_fst$LG ==10,]$qval)
yy[yy > 10000] = 5
scatter.smooth(xx, yy, span = .2, evaluation =10)
scatter.smooth(xx, yy, span = .1, evaluation =10)
xx = map_fst[map_fst$LG ==10,]$cM
yy = -log10(map_fst[map_fst$LG ==10,]$qval)
yy[yy > 10000] = 5
scatter.smooth(xx, yy, span = .1, evaluation =100)
scatter.smooth(xx, yy, span = .01, evaluation =100)
scatter.smooth(xx, yy, span = .01, evaluation =200)
scatter.smooth(xx, yy, span = .1, evaluation =200)
scatter.smooth(xx, yy, span = .1, evaluation =200)
scatter.smooth(xx, yy, span = .1, evaluation =500)
xx = map_fst[map_fst$LG ==10,]$cM
yy = -log10(map_fst[map_fst$LG ==10,]$qval)
#yy[yy > 10000] = 5
scatter.smooth(xx, yy, span = .1, evaluation =500)
scatter.smooth(xx, yy, span = .1, evaluation =100)
xx = map_fst[map_fst$LG ==10,]$cM
yy = map_fst[map_fst$LG ==10,]$BS_Fst
scatter.smooth(xx, yy, span = .1, evaluation =100)
xx = map_fst[map_fst$LG ==10,]$cM
yy = map_fst[map_fst$LG ==10,]$WC_Fst
#yy[yy > 10000] = 5
scatter.smooth(xx, yy, span = .1, evaluation =100)
scatter.smooth(xx, yy, span = .2, evaluation =100)
scatter.smooth(xx, yy, span = .15, evaluation =100)
scatter.smooth(xx, yy, span = .15, evaluation =200)
scatter.smooth(xx, yy, span = .15, evaluation =50)
scatter.smooth(xx, yy, span = .15, evaluation =5)
scatter.smooth(xx, yy, span = .15, evaluation =40)
scatter.smooth(xx, yy, span = .5, evaluation =40)
scatter.smooth(xx, yy, span = .25, evaluation =40)
scatter.smooth(xx, yy, span = .05, evaluation =40)
scatter.smooth(xx, yy, span = .1, evaluation =40)
xx = map_fst[map_fst$LG ==8,]$cM
yy = map_fst[map_fst$LG ==8,]$WC_Fst
#yy[yy > 10000] = 5
scatter.smooth(xx, yy, span = .1, evaluation =40)
xx = map_fst[map_fst$LG ==8,]$cM
yy = map_fst[map_fst$LG ==8,]$BS_Fst
#yy[yy > 10000] = 5
scatter.smooth(xx, yy, span = .1, evaluation =40)
warnings()
scatter.smooth(xx, yy, span = .1, degree = 2,  evaluation =40)
xx = map_fst[map_fst$LG ==8,]$cM
yy = map_fst[map_fst$LG ==8,]$BS_Fst
#yy[yy > 10000] = 5
scatter.smooth(xx, yy, span = .1, degree = 2,  evaluation =40)
scatter.smooth(xx, yy, span = .2, degree = 2,  evaluation =40)
scatter.smooth(xx, yy, span = .2, evaluation =40)
scatter.smooth(xx, yy, span = .1, evaluation =40)
xx = map_fst[map_fst$LG ==10,]$cM
yy = map_fst[map_fst$LG ==10,]$WC_Fst
#yy[yy > 10000] = 5
scatter.smooth(xx, yy, span = .1, evaluation =40)
scatter.smooth(xx, yy, span = .1, degree = 2, evaluation =40)
scatter.smooth(xx, yy, span = .1, degree = 2, evaluation =100)
warnings
warnings()
scatter.smooth(xx, yy, span = .2, degree = 2, evaluation =100)
scatter.smooth(xx, yy, span = .2, degree = 7, evaluation =100)
scatter.smooth(xx, yy, span = .2, degree = 2, evaluation =100)
scatter.smooth(xx, yy, span = .2, degree = 1, evaluation =100)
scatter.smooth(xx, yy, span = .2, degree = 0, evaluation =100)
scatter.smooth(xx, yy, span = .1, degree = 0, evaluation =100)
scatter.smooth(xx, yy, span = .1, degree = 1, evaluation =100)
scatter.smooth(xx, yy, span = .1, degree = 2, evaluation =100)
scatter.smooth(xx, yy, span = .2, degree = 2, evaluation =100)
scatter.smooth(xx, yy, span = .2, degree = 2, evaluation =100)
xx = map_fst[map_fst$LG ==8,]$cM
yy = map_fst[map_fst$LG ==8,]$BS_Fst
#yy[yy > 10000] = 5
scatter.smooth(xx, yy, span = .2, degree = 2, evaluation =100)
scatter.smooth(xx, yy, span = .5, degree = 2, evaluation =100)
xx = map_fst[map_fst$LG ==10,]$cM
yy = map_fst[map_fst$LG ==10,]$WC_Fst
#yy[yy > 10000] = 5
scatter.smooth(xx, yy, span = .5, degree = 2, evaluation =100)
scatter.smooth(xx, yy, span = .5, degree = 3, evaluation =100)
xx = map_fst[map_fst$LG ==10,]$cM
yy = map_fst[map_fst$LG ==10,]$WC_Fst
#yy[yy > 10000] = 5
scatter.smooth(xx, yy, span = .5, degree = 3, evaluation =100)
scatter.smooth(xx, yy, span = .25, degree = 3, evaluation =100)
scatter.smooth(xx, yy, span = .25, degree = 2, evaluation =100)
xx = map_fst[map_fst$LG ==10,]$cM
yy = map_fst[map_fst$LG ==10,]$BS_Fst
#yy[yy > 10000] = 5
scatter.smooth(xx, yy, span = .25, degree = 2, evaluation =100)
scatter.smooth(xx, yy, span = .1, degree = 2, evaluation =100)
